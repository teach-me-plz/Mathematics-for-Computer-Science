# 확장 유클리드 알고리즘이란?

유클리드 알고리즘의 확장으로 정수 $a$와 $b$의 최대 공약수 외에도 다음과 같은 [베주 항등식](../용어%20정리/베주%20항등식(Bézouts%20identity).md)의 계수도 계산한다.   

$$ ax + by = gcd(a, b) $$

이 알고리즘은 $a$와 $b$가 서로소일 때 특히 유용하며 암호학에서 널리 사용된다.

이 경우 $x$는 $a$의 모듈러 $b$에 대한 모듈러 곱셈 역원 이고 $y$는 $b$의 모듈러 $a$에 대한 모듈러 곱셈 역원이다.   

특히 모듈러 곱셈 역원의 계산은 RSA 공개 키 암호화 방식에서 키 쌍을 유도하는데 필수적인 단계이다.   


표준 유클리드 알고리즘에서는 몫을 사용하지않고 나머지만 유지시켜 계산을 이어나가지만 확장 알고리즘에서는 연속된 몫을 사용한다.   

$a$와 $b$를 입력으로 사용하는 표준 유클리드 알고리즘은 다음과 같은 수열을 계산한다.   

몫과 나머지의 수열 $q_1, ..., q_k , r_0, ..., r_{k + 1}$의 경우.   

$$ r_0 = a $$
$$ r_1 = b $$
$$ . $$
$$ . $$
$$ . $$
$$ r_{i + 1} = r_{i - 1} - q_{i}r_{i} \quad and \quad 0 \le r_{i + 1} < |r_{i}| $$
$$ . $$
$$ . $$
$$ . $$

## 컴퓨터에서의 구현

다음 표는 240과 46을 확장 유클리드 알고리즘에 넣어보았을때의 계산을 나타낸 것이다.   
| 순서 | 몫($q_{i - 1}$) | 나머지($r_{i}$) | $s_{i}$ | $t_{i}$ | 
|-|-|-|-|-|
| 0 |  | $240$ | $1$ | $0$ |
| 1 |  | $46$ | $0$ | $1$ |
| 2 | $240 / 46 = 5$ | $240 - 5 * 46 = 10$ | $1 - 5 * 0 = 1$ | $0 − 5 * 1 = (−5)$ |
| 3 | $46 / 10 = 4$ | $26 - 4 * 10 = 6$ | $0 - 4 * 1 = (-4)$ | $1 - 4 * (-5) = 21$ |
| 4 | $10 / 6 = 1$ | $10 - 1 * 6 = 4$ | $1 - 1 * (-4) = 5$ | $(-5) - 1 * 21 = (-26)$ |
| 5 | $6 / 4 = 1$ | $6 - 1 * 4 = 2$ | $(-4) - 1 * 5 = (-9)$ | $21 - 1 * (-26) = 47$ |  
| 6 | $4 / 2 = 2$ | $4 - 2 * 2 = 0$ | $5 - 2 * (-9) = 23$ | $(-26) - 2 * 47 = (-120)$ |
